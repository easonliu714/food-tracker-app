import { getLocales } from 'expo-localization'; // 如果沒有安裝此套件，可改用 Intl
import { getSettings } from './storage';

export const LANGUAGES = [
  { code: 'zh-TW', label: '繁體中文' },
  { code: 'en', label: 'English' },
  { code: 'ja', label: '日本語' },
  { code: 'ko', label: '한국어' },
  { code: 'fr', label: 'Français' },
  { code: 'ru', label: 'Русский' },
];

export const TRANSLATIONS = {
  'zh-TW': {
    activity_level: '活動量',
    sedentary: '久坐',
    lightly_active: '輕度活動',
    moderately_active: '中度活動',
    very_active: '高度活動',
    extra_active: '極度活動',
    gender: '性別',
    male: '男',
    female: '女',
    birth_year: '出生年',
    height: '身高(cm)',
    weight: '體重(kg)',
    body_fat: '體脂率(%)',
    target_weight: '目標(kg)',
    goal: '目標',
    lose_weight: '減重',
    maintain: '維持',
    gain_weight: '增重',
    daily_target: '每日目標',
    save_settings: '儲存設定',
    logout: '登出',
    version_history: '版次歷程',
    ai_settings: 'AI 設定',
    current_model: '目前使用模型',
    test_key: '測試並取得模型',
    api_key_placeholder: '請貼上您的 API Key',
    trend_analysis: '趨勢分析',
    intake: '攝取',
    burned: '消耗',
    protein: '蛋',
    carbs: '碳',
    fat: '油',
    sodium: '鈉',
    week: '周',
    month_day: '月(日)',
    month_week: '月(週)',
    year: '年',
    manual_input: '手輸',
    photo: '拍照',
    scan: '掃碼',
    workout: '運動',
    today_overview: '今日概覽',
    quick_record: '快速紀錄',
    no_record: '尚無紀錄',
    ai_coach: 'AI 智能教練',
    recipe_suggestion: '食譜建議',
    workout_suggestion: '運動建議',
    generate_plan: '生成計畫',
    remaining_budget: '目前剩餘額度',
    watch_video: '觀看教學影片',
    ingredients: '食材',
    steps: '步驟',
    reason: '建議原因',
    estimated_weight: '估計重量 (g)',
    confirm_save: '確認並儲存',
    food_name: '食物名稱',
    calories: '熱量',
    suggestion_limit: '每日建議攝取量',
    alert_over: '超過建議值',
  },
  'en': {
    activity_level: 'Activity Level',
    sedentary: 'Sedentary',
    lightly_active: 'Lightly Active',
    moderately_active: 'Moderately Active',
    very_active: 'Very Active',
    extra_active: 'Extra Active',
    gender: 'Gender',
    male: 'Male',
    female: 'Female',
    birth_year: 'Birth Year',
    height: 'Height (cm)',
    weight: 'Weight (kg)',
    body_fat: 'Body Fat (%)',
    target_weight: 'Target (kg)',
    goal: 'Goal',
    lose_weight: 'Lose Weight',
    maintain: 'Maintain',
    gain_weight: 'Gain Weight',
    daily_target: 'Daily Target',
    save_settings: 'Save Settings',
    logout: 'Logout',
    version_history: 'Version History',
    ai_settings: 'AI Settings',
    current_model: 'Current Model',
    test_key: 'Test & Get Models',
    api_key_placeholder: 'Paste your API Key here',
    trend_analysis: 'Trend Analysis',
    intake: 'Intake',
    burned: 'Burned',
    protein: 'Prot',
    carbs: 'Carb',
    fat: 'Fat',
    sodium: 'Sod',
    week: 'Week',
    month_day: 'Month(Day)',
    month_week: 'Month(Week)',
    year: 'Year',
    manual_input: 'Manual',
    photo: 'Photo',
    scan: 'Scan',
    workout: 'Workout',
    today_overview: 'Today Overview',
    quick_record: 'Quick Add',
    no_record: 'No records',
    ai_coach: 'AI Coach',
    recipe_suggestion: 'Recipe',
    workout_suggestion: 'Workout',
    generate_plan: 'Generate Plan',
    remaining_budget: 'Remaining Budget',
    watch_video: 'Watch Video',
    ingredients: 'Ingredients',
    steps: 'Steps',
    reason: 'Reason',
    estimated_weight: 'Est. Weight (g)',
    confirm_save: 'Confirm & Save',
    food_name: 'Food Name',
    calories: 'Calories',
    suggestion_limit: 'Daily Suggestion',
    alert_over: 'Exceeded',
  },
  // 其他語言可依此類推，為節省篇幅先以英文作為預設回退
  'ja': { activity_level: '活動レベル', male: '男', female: '女', save_settings: '設定を保存', logout: 'ログアウト' },
  'ko': { activity_level: '활동 수준', male: '남성', female: '여성', save_settings: '설정 저장', logout: '로그아웃' },
  'fr': { activity_level: "Niveau d'activité", male: 'Homme', female: 'Femme', save_settings: 'Enregistrer', logout: 'Se déconnecter' },
  'ru': { activity_level: 'Уровень активности', male: 'Мужской', female: 'Женский', save_settings: 'Сохранить', logout: 'Выйти' },
};

export const VERSION_LOGS = [
  { version: '1.0.3', date: '2025-12-20', content: '新增多語言支援(繁/英/日/韓/法/俄)；新增體脂率紀錄；趨勢分析增加年/月/週切換；AI 邏輯優化(正餐判斷、無輔具運動、影片連結)。' },
  { version: '1.0.2', date: '2025-12-18', content: '修正 AI 金鑰失效問題，開放使用者自訂 API Key；修正條碼掃描無法儲存問題；優化趨勢圖表顯示(雙軸)；新增左滑編輯功能。' },
  { version: '1.0.1', date: '2025-12-15', content: '基本功能發布：飲食紀錄、卡路里計算、個人檔案管理、AI 拍照辨識、條碼掃描。' },
];

export const t = (key: string, lang: string = 'zh-TW') => {
  const dict = TRANSLATIONS[lang as keyof typeof TRANSLATIONS] || TRANSLATIONS['en'];
  return dict[key as keyof typeof dict] || TRANSLATIONS['zh-TW'][key as any] || key;
};

// 簡單的語言偵測
export const detectLanguage = () => {
  // 由於在 Codespaces 環境無法準確模擬手機，這裡預設繁體中文，實際 APP 可結合 expo-localization
  return 'zh-TW'; 
};